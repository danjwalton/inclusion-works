crs$disqualified <- 0
crs[broad+narrow>0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[broad+narrow>0]$project_title, crs[broad+narrow>0]$short_description, crs[broad+narrow>0]$long_description)))]$disqualified <- 1
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | narrow == 1) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | narrow == 1) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
View(sectors)
broad.keywords <- c(
"disabl"
,
"injured", "injuries"
,
"disorder"
,
"impairment", "impaired"
,
"pwd", "gwd", "cwd"
,
"therapy"
,
"chronic"
,
"deaf"
,
"blind"
,
"special needs"
,
"autistic", "autism"
)
narrow.keywords <- c(
"arthriti"
,
"rheumat"
,
"amputation", "amputee", "amputate"
,
"schizophreni"
,
"sign language"
,
"prosthes"
,
"landmine"
,
"wounded"
)
disqualifying.keywords <- c(
"chronic malnutrition"
,
"mole rat"
)
crs$broad <- 0
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$long_description))]$broad <- 1
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$short_description))]$broad <- 2
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$project_title))]$broad <- 2
crs$narrow <- 0
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]$narrow <- 1
crs$disqualified <- 0
crs[broad+narrow>0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[broad+narrow>0]$project_title, crs[broad+narrow>0]$short_description, crs[broad+narrow>0]$long_description)))]$disqualified <- 1
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | narrow == 1) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | narrow == 1) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
View(sectors)
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(max(c(broad,narrow)) == 1) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(max(c(broad,narrow)) == 1) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
View(sectors)
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
rt <- crs[purpose_name=="Road transport"]
View(rt)
broad.keywords <- c(
"disabl"
,
"injured", "injuries"
,
"disorder"
,
"impairment", "impaired"
,
"pwd", "gwd", "cwd"
,
"therapy"
,
"chronic health", "chronic ill"
,
"deaf"
,
"blind"
,
"special needs"
,
"autistic", "autism"
)
narrow.keywords <- c(
"arthriti"
,
"rheumat"
,
"amputation", "amputee", "amputate"
,
"schizophreni"
,
"sign language"
,
"prosthes"
,
"landmine"
,
"wounded"
)
disqualifying.keywords <- c(
"chronic malnutrition"
,
"mole rat"
,
"cgpwd"
,
"road"
)
crs$broad <- 0
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$long_description))]$broad <- 1
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$short_description))]$broad <- 2
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$project_title))]$broad <- 2
crs$narrow <- 0
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]$narrow <- 1
crs$disqualified <- 0
crs[broad+narrow>0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[broad+narrow>0]$project_title, crs[broad+narrow>0]$short_description, crs[broad+narrow>0]$long_description)))]$disqualified <- 1
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
rt <- crs[purpose_name=="Road transport"]
View(rt)
rt <- crs[purpose_name=="Informal/semi-formal financial intermediaries"]
View(rt)
rt <- crs[grepl("disorder",tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]
View(rt)
broad.keywords <- c(
"disabl"
,
"injured", "injuries"
#,
#"disorder"
,
"impairment", "impaired"
,
"pwd", "gwd", "cwd"
,
"therapy"
,
"chronic health", "chronic ill"
,
"deaf"
,
"blind"
,
"special needs"
,
"autistic", "autism"
)
crs$broad <- 0
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$long_description))]$broad <- 1
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$short_description))]$broad <- 2
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(crs$project_title))]$broad <- 2
crs$narrow <- 0
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]$narrow <- 1
crs$disqualified <- 0
crs[broad+narrow>0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[broad+narrow>0]$project_title, crs[broad+narrow>0]$short_description, crs[broad+narrow>0]$long_description)))]$disqualified <- 1
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
rt <- crs[grepl("disorder",tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]
narrow.keywords <- c(
"arthriti"
,
"rheumat"
,
"amputation", "amputee", "amputate"
,
"schizophreni"
,
"sign language"
,
"prosthes"
,
"landmine"
,
"wounded"
,
"mental health"
)
crs$narrow <- 0
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]$narrow <- 1
crs$disqualified <- 0
crs[broad+narrow>0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[broad+narrow>0]$project_title, crs[broad+narrow>0]$short_description, crs[broad+narrow>0]$long_description)))]$disqualified <- 1
years <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(year)]
sectors <- crs[,.(major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T), minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)), by=.(purpose_name)]
sectors <- sectors[major+minor>0]
years <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
)
, by=.(year)]
sectors <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
)
, by=.(purpose_name)]
sectors <- sectors[major+minor>0]
donors <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
)
, by=.(donor_name)]
recipients <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
)
, by=.(recipient_name)]
View(donors)
View(recipients)
years <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(year)]
sectors <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(purpose_name)]
sectors <- sectors[major+minor>0]
donors <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(donor_name)]
recipients <- crs[,.(
major=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(broad == 0 & narrow == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[broad == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(broad == 1 | (narrow ==1 & broad < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(recipient_name)]
length(crs$narrow==1)
length(crs$narrow)
length(crs[narrow==1])
nrow(crs[narrow==1])
nrow(crs[broad==1])
nrow(crs[broad==1 | narrow == 1])
required.packages <- c("reshape2", "ggplot2", "data.table")
lapply(required.packages, require, character.only = T)
wd <- "G:/My Drive/Work/GitHub/inclusion-works/"
setwd(wd)
load("project-data/crs.RData")
keep <- c(
"crs_id"
,
"year"
,
"aid_type"
,
"flow_name"
,
"donor_name"
,
"recipient_name"
,
"usd_commitment_deflated"
,
"usd_disbursement_deflated"
,
"purpose_name"
,
"project_title"
,
"short_description"
,
"long_description"
)
crs <- crs[, ..keep]
narrow.keywords <- c(
"disabl"
#,
#"disorder"
,
"impairment", "impaired"
,
"pwd", "gwd", "cwd"
,
"chronic health", "chronic ill"
,
"deaf"
,
"blind"
,
"special needs"
,
"autistic", "autism"
,
"mental health"
,
"prosthes"
,
"amputation", "amputee", "amputate"
,
"schizophreni"
,
"sign language"
,
"arthriti"
,
"rheumat"
,
"dementia"
)
broad.keywords <- c(
"war victim"
,
"landmine"
,
"wounded"
,
"injured", "injuries"
,
"therapy"
)
disqualifying.keywords <- c(
"chronic malnutrition"
,
"mole rat"
,
"cgpwd"
,
"road"
,
"highway"
)
crs$narrow <- 0
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(crs$long_description))]$narrow <- 1
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(crs$short_description))]$narrow <- 2
crs[grepl(paste(narrow.keywords, collapse = "|"), tolower(crs$project_title))]$narrow <- 2
crs$broad <- 0
crs[grepl(paste(broad.keywords, collapse = "|"), tolower(paste(crs$project_title, crs$short_description, crs$long_description)))]$broad <- 1
crs$disqualified <- 0
crs[narrow + broad > 0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[narrow + broad > 0]$project_title, crs[broad+narrow>0]$short_description, crs[narrow + broad > 0]$long_description)))]$disqualified <- 1
years <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(year)]
sectors <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(purpose_name)]
sectors <- sectors[major+minor>0]
donors <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(donor_name)]
recipients <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(recipient_name)]
View(sectors)
rt <- crs[purpose_name=="Biosphere protection"]
View(rt)
disqualifying.keywords <- c(
"chronic malnutrition"
,
"mole rat"
,
"cgpwd"
,
"road"
,
"highway"
,
"enviromental health"
)
crs$disqualified <- 0
crs[narrow + broad > 0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[narrow + broad > 0]$project_title, crs[broad+narrow>0]$short_description, crs[narrow + broad > 0]$long_description)))]$disqualified <- 1
years <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(year)]
sectors <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(purpose_name)]
sectors <- sectors[major+minor>0]
donors <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(donor_name)]
recipients <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(recipient_name)]
View(rt)
rt <- crs[purpose_name=="Biosphere protection"]
disqualifying.keywords <- c(
"chronic malnutrition"
,
"mole rat"
,
"cgpwd"
,
"road"
,
"highway"
,
"enviromental health"
)
crs$disqualified <- 0
crs[narrow + broad > 0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[narrow + broad > 0]$project_title, crs[broad+narrow>0]$short_description, crs[narrow + broad > 0]$long_description)))]$disqualified <- 1
rt <- crs[purpose_name=="Biosphere protection"]
disqualifying.keywords <- c(
"chronic malnutrition"
,
"mole rat"
,
"cgpwd"
,
"road"
,
"highway"
,
"environmental health"
)
crs$disqualified <- 0
crs[narrow + broad > 0][grepl(paste(disqualifying.keywords, collapse = "|"), tolower(paste(crs[narrow + broad > 0]$project_title, crs[broad+narrow>0]$short_description, crs[narrow + broad > 0]$long_description)))]$disqualified <- 1
rt <- crs[purpose_name=="Biosphere protection"]
years <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(year)]
sectors <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(purpose_name)]
sectors <- sectors[major+minor>0]
donors <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(donor_name)]
recipients <- crs[,.(
major=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)
, minor=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)
, none=sum(usd_disbursement_deflated[(narrow == 0 & broad == 0) | disqualified == 1], na.rm=T)
, major.share=sum(usd_disbursement_deflated[narrow == 2 & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
, minor.share=sum(usd_disbursement_deflated[(narrow == 1 | (broad ==1 & narrow < 2)) & disqualified == 0], na.rm=T)/sum(usd_disbursement_deflated, na.rm=T)
)
, by=.(recipient_name)]
